function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,n){if(e){if("string"==typeof e)return _arrayLikeToArray(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,n):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,n){(null==n||n>e.length)&&(n=e.length);for(var o=0,s=new Array(n);o<n;o++)s[o]=e[o];return s}define(["exports","preact/jsx-runtime","preact","preact/compat","./hooks/UNSAFE_useFocusableTextField","./hooks/UNSAFE_useFormContext","./hooks/UNSAFE_useFormFieldContext","./hooks/UNSAFE_useLoadingIndicatorTimer","./hooks/UNSAFE_useTextField","./UNSAFE_Flex","./UNSAFE_Label","./UNSAFE_LiveRegion","./UNSAFE_TextField","./UNSAFE_UserAssistance","./PRIVATE_SelectCommon","./tslib.es6-42e4f430",'module',"./UNSAFE_Chip","./hooks/UNSAFE_useTranslationBundle","./Chip-ff8df610","preact/hooks","./utils/UNSAFE_mergeProps","./ReadonlyTextFieldInput-8040cb97","./TextFieldInput-428b8905","./Flex-348d5a41"],function(e,n,o,s,t,i,a,l,r,d,u,c,p,v,f,y,b,h,m,g,F,S,x,w,A){"use strict";function D(e){var{accessibleLabel:o,count:s=0,onKeyDown:t,onKeyUp:i,onMouseDown:a}=e,l=y.__rest(e,["accessibleLabel","count","onKeyDown","onKeyUp","onMouseDown"]);const r=m.useTranslationBundle("@oracle/oraclejet-preact"),d=r.selectMultiple_showSelectedValues(),u=o?`${o}. `:"",c=r.selectMultiple_countPlus({COUNT:"99"}),p=s>99?`${c}`:`${s}`,v=`${u}${r.selectMultiple_valuesSelected({VALUE_COUNT:`${s}`})} ${d}`;return n.jsx("div",Object.assign({class:"_10pv3vt",onKeyDown:t,onKeyUp:i,onMouseDown:a},{children:n.jsx(g.Chip,Object.assign({accessibleLabel:v},l,{children:p}))}))}function T(e,n){const o=m.useTranslationBundle("@oracle/oraclejet-preact").plural_separator(),s=F.useMemo(()=>{if(void 0===n)return"";const s=function(e,n){const o=n?_toConsumableArray(null==n?void 0:n.values()):[],s=n=>f.renderItemText(n,e),t=o.map(s);return new Set(t)}(e,n),t=function(e,n){return Array.from(e.values()).join(n)}(s,o);return t},[n,e]);return s}function E({data:e,inputRef:n,isDisabled:o,isFocused:s,isReadonly:t,onCommit:i,onFilter:a,onLoadRange:l,valueItems:r}){const[d,u]=F.useState(!1),c=null==r?void 0:r.length,p=void 0!==c&&c>0||d,v=function({isDropdownSelectedOnlyView:e,valueItems:n}){return{data:F.useMemo(()=>{var o;return e&&n&&0!==n.length?{offset:0,totalSize:null!==(o=null==n?void 0:n.length)&&void 0!==o?o:0,sizePrecision:"exact",data:n.map(e=>{var n;return{data:e.data,metadata:null!==(n=e.metadata)&&void 0!==n?n:{key:e.key}}})}:void 0},[e]),onLoadRange:void 0}}({isDropdownSelectedOnlyView:d,valueItems:r}),y=d?v.data:e,b=d?v.onLoadRange:l,{currentRow:h,dropdownRef:m,handleDropdownArrowClick:g,handleDropdownAutoDismiss:x,handleInput:w,handleMainFieldKeyDown:A,handleMainFieldKeyUp:D,handleUpDownArrowKeys:T,isDropdownOpen:E,isFocused:j,isUserFiltering:C,mainFieldRef:R,onCurrentKeyChange:_,onMouseDown:L,searchText:K,selectedKeys:O,setCurrentRow:U,setDropdownOpen:k,setSelectedKeys:I,userInput:P}=f.useSelectCommon({data:y,inputRef:n,isFocused:s,onFilter:a}),M=F.useCallback(()=>{var e,n;null===(n=null===(e=m.current)||void 0===e?void 0:e.parentElement)||void 0===n||n.removeChild(m.current)},[]),N=F.useCallback(e=>{var o,s;if(E&&"keydown"===(null==e?void 0:e.type)){const t=e;if(t.code===f.KEYS.TAB)t.shiftKey||!p?null===(o=n.current)||void 0===o||o.focus():null===(s=V.current)||void 0===s||s.focus(),M()}},[p,E]),B=F.useCallback(e=>{if(!f.isControlOrFunctionKey(e)&&e.code===f.KEYS.TAB)E&&(e.shiftKey||!p&&!e.shiftKey)&&(M(),k(!1)),p&&!e.shiftKey&&e.stopPropagation()},[p,E]);F.useEffect(()=>{const e=null==r?void 0:r.reduce((e,n)=>(e.add(n.key),e),new Set);I(e)},[r]);const V=F.useRef(null);F.useEffect(()=>{V.current=p&&R.current?R.current.querySelector('[role="switch"]'):null},[p,o,t]);const z=F.useCallback(e=>{switch(e.code){case f.KEYS.TAB:E&&!e.shiftKey&&(M(),k(!1)),e.shiftKey&&e.stopPropagation();break;case f.KEYS.UP:case f.KEYS.DOWN:e.preventDefault();break;case f.KEYS.ESC:E&&(k(!1),e.preventDefault(),e.stopPropagation());break;case f.KEYS.ENTER:e.stopPropagation()}},[E]),$=F.useCallback(e=>{switch(e.code){case f.KEYS.UP:case f.KEYS.DOWN:T(e)}},[T]),Y=F.useCallback(e=>{var o;e.preventDefault(),null===(o=n.current)||void 0===o||o.focus()},[]),H=F.useCallback(e=>{var n;E||k(!0);const o=null!==(n=e.value)&&void 0!==n&&n;o!==d&&u(o)},[E,d]);F.useEffect(()=>{!E&&d&&u(!1)},[E,d]);const W=F.useCallback(e=>{var n;const o=new Set(null===(n=e.value.keys)||void 0===n?void 0:n.values());I(o),null==i||i({value:o,previousValue:O})},[i,O]),q=F.useMemo(()=>S.mergeProps({onAutoDismiss:x},{onAutoDismiss:N}),[x,N]),Z=F.useMemo(()=>S.mergeProps({onInput:w,onKeyDown:A,onKeyUp:D},{onKeyDown:B}),[A,w,D,B]);return F.useEffect(()=>{E&&U({rowKey:void 0})},[E]),{collectionProps:{currentKey:h.rowKey,onCurrentKeyChange:_,onSelectionChange:W,selectedKeys:O},data:y,dropdownArrowEventHandlers:{onClick:g},dropdownEventHandlers:q,dropdownRef:m,hasSelectedValuesCount:p,inputEventHandlers:Z,inputRef:n,isDropdownOpen:E,isDropdownSelectedOnlyView:d,isFocused:j,isUserFiltering:C,mainFieldRef:R,mouseProps:o||t?{}:{onMouseDown:L},onLoadRange:b,searchText:K,selectedValuesCountProps:{onKeyDown:z,onKeyUp:$,onMouseDown:Y,onToggle:H},userInput:P}}const j=s.forwardRef(({ariaDescribedBy:e,assistiveText:s,data:d,helpSourceLink:y,helpSourceText:b,isDisabled:h,isLoading:g,isReadonly:F,isRequired:S,isRequiredShown:j,itemText:C,label:R,labelEdge:_,labelStartWidth:L,messages:K,onCommit:O,onFilter:U,onLoadRange:k,placeholder:I,textAlign:P,userAssistanceDensity:M,valueItems:N,variant:B="default",virtualKeyboard:V},z)=>{const{isDisabled:$,isReadonly:Y,labelEdge:H,labelStartWidth:W,textAlign:q,userAssistanceDensity:Z}=i.useFormContext(),G=null!=h?h:$,J=null!=F?F:Y,Q=null!=_?_:H,X=null!=L?L:W,ee=null!=P?P:q,ne=null!=M?M:Z,{enabledElementRef:oe,focusProps:se,isFocused:te,readonlyElementRef:ie}=t.useFocusableTextField({isDisabled:G,isReadonly:J,ref:z}),{collectionProps:ae,data:le,dropdownArrowEventHandlers:re,dropdownEventHandlers:de,dropdownRef:ue,hasSelectedValuesCount:ce,inputEventHandlers:pe,isDropdownOpen:ve,isDropdownSelectedOnlyView:fe,isFocused:ye,isUserFiltering:be,mainFieldRef:he,mouseProps:me,onLoadRange:ge,searchText:Fe,selectedValuesCountProps:Se,userInput:xe}=E({data:d,inputRef:oe,isDisabled:G,isFocused:te,isReadonly:J,onCommit:O,onFilter:U,onLoadRange:k,valueItems:N}),we=l.useLoadingIndicatorTimer(null!=g&&g),{baseId:Ae,formFieldContext:De,inputProps:Te,labelProps:Ee,textFieldProps:je,userAssistanceProps:Ce}=r.useTextField({ariaDescribedBy:e,isDisabled:G,isFocused:ye,isLoading:we,isReadonly:J,labelEdge:Q,messages:K,styleVariant:B,value:void 0!==N&&N.length>0||void 0}),Re=`${Ae}-dropdown`,_e=T(C,N),Le="none"!==Q?n.jsx(u.Label,Object.assign({},Ee,{children:R})):void 0,Ke={label:"none"!==Q?Le:void 0,labelEdge:"none"!==Q?Q:void 0,labelStartWidth:"none"!==Q?X:void 0},Oe="none"===Q?R:void 0,Ue=G||J?"efficient"!==ne?void 0:n.jsx(v.InlineUserAssistance,Object.assign({userAssistanceDensity:ne},Ce)):n.jsx(v.InlineUserAssistance,Object.assign({assistiveText:s,fieldLabel:R,helpSourceLink:y,helpSourceText:b,messages:K,isRequiredShown:j,userAssistanceDensity:ne},Ce)),ke=m.useTranslationBundle("@oracle/oraclejet-preact");if(J)return n.jsx(a.FormFieldContext.Provider,Object.assign({value:De},{children:n.jsx(p.ReadonlyTextField,Object.assign({role:"presentation",inlineUserAssistance:Ue,onBlur:se.onfocusout,onFocus:se.onfocusin},Ke,{children:n.jsx(x.ReadonlyTextFieldInput,{ariaDescribedBy:e,ariaLabel:Oe,ariaLabelledBy:Ee.id,as:"div",elementRef:ie,hasInsideLabel:void 0!==R&&"inside"===Q,textAlign:ee,value:_e})}))}));const Ie=null!=le&&!f.isBeforeDataFetch(le),Pe=void 0!==Le&&"inside"===Q,Me=ve&&Ie?0===(null==le?void 0:le.totalSize)?ke.select_noMatchesFound():1===(null==le?void 0:le.totalSize)?ke.select_oneMatchFound():"exact"===(null==le?void 0:le.sizePrecision)?ke.select_sizeMatchesFound({TOTAL_SIZE:`${null==le?void 0:le.totalSize}`}):ke.select_sizeOrMoreMatchesFound({TOTAL_SIZE:`${null==le?void 0:le.totalSize}`}):"",Ne=n.jsxs(o.Fragment,{children:[n.jsx(w.TextFieldInput,Object.assign({ariaAutoComplete:"list",ariaControls:Re,ariaExpanded:ve,ariaLabel:Oe,autoComplete:"off",hasInsideLabel:Pe,inputRef:oe,isRequired:S},pe,{placeholder:I,role:"combobox",spellcheck:!1,textAlign:ee,type:f.isMobile()?"auto"===V?"search":V:void 0,value:be?xe:_e},Te)),n.jsx(c.LiveRegion,{children:Me})]}),Be=n.jsx(f.DropdownArrow,Object.assign({isDisabled:G,size:Pe?"md":"sm"},re)),Ve=null==N?void 0:N.length,ze=we?void 0:ce?n.jsxs(A.Flex,Object.assign({align:"center",justify:"center",gap:[0,"1x"]},{children:[n.jsx(D,Object.assign({accessibleLabel:R,count:Ve,isDisabled:G,isSelected:fe},Se)),Be]})):Be,$e=!ve||G||J||!s&&!y||"efficient"!==ne&&"reflow"!==ne?void 0:n.jsx(f.DropdownUserAssistance,{assistiveText:s,fieldLabel:R,helpSourceLink:y,helpSourceText:b,userAssistanceDensity:ne}),Ye=Ie&&0===(null==le?void 0:le.totalSize),He=Ye?n.jsx(f.EmptyResults,{}):n.jsx(f.DefaultList,Object.assign({},ae,{accessibleSummary:null!=R?R:"",data:le,itemText:C,onLoadRange:ge,searchText:fe?void 0:be?Fe:void 0,selectionMode:"multiple"}));return n.jsxs(o.Fragment,{children:[n.jsx(a.FormFieldContext.Provider,Object.assign({value:De},{children:n.jsx(p.TextField,Object.assign({endContent:ze,inlineUserAssistance:Ue,mainContent:Ne,mainFieldRef:he,onBlur:null==se?void 0:se.onfocusout,onFocus:null==se?void 0:se.onfocusin},je,Ke,me))})),n.jsxs(f.Dropdown,Object.assign({dropdownRef:ue,id:Re,isOpen:ve&&void 0!==le&&(null===le||le.totalSize>0||f.isBeforeDataFetch(le)||Ye),anchorRef:he},de,{children:[n.jsx(f.DropdownList,Object.assign({hasBottomGap:void 0===$e,isLoading:null===le},{children:He})),$e]}))]})});e.SelectMultiple=j});
//# sourceMappingURL=SelectMultiple-48f32c18.js.map
