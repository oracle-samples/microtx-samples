define(["exports","preact/jsx-runtime","preact/hooks","./PRIVATE_Collection","./utils/UNSAFE_arrayUtils","./hooks/UNSAFE_useViewportIntersect","./Collection-a29e53a2"],function(e,t,o,n,r,i,l){"use strict";r.stringLiteralArray(["topPlaceholder","bottomPlaceholder"]);const c="oj-collection-placeholder",s=({context:e,placeholderHeight:o})=>{const{fromIndex:n,toIndex:r,which:i,estimateItemSize:l}=e;let s=0;if(o)s=o(e);else{const e=0===l?48:l;s=Math.max(0,r-n)*e}const a="topPlaceholder"===i?"_topPlaceholder":"_bottomPlaceholder",d={height:s+"px"};return 0===s&&(d.display="none"),t.jsx("div",{className:c,style:d},a)};function a(e){return function({itemSize:t,viewportHeight:o,scrollOffset:n,overscan:r=0}){if(void 0===t||0===t||void 0===o||void 0===n)return{offset:0,count:e};const i=Math.ceil(n/t),l=Math.ceil(o/t);return{offset:Math.max(0,i-r),count:l+r*(i>0?2:1)}}}const d=(e,t,o,n,r)=>{let i,l;if(e&&t){const o=t.getBoundingClientRect(),n=(e=>{let t,o;if(e===document.documentElement)t=0,o=document.documentElement.clientHeight;else{const n=e.getBoundingClientRect();t=n.top,o=n.bottom}return{top:t,bottom:o}})(e);o&&n&&(i=n.top-o.top-1,l=n.bottom-n.top+1)}if(void 0!==i&&void 0!==l){return n({scrollOffset:i,viewportHeight:l,overscan:o,itemSize:r})}return null},u="oj-collection-loadmore",h=a(25);e.PLACEHOLDER_STYLE_CLASS=c,e.VirtualizedCollection=function({data:e,children:n,viewportConfig:r,itemSelector:c,placeholderHeight:a,rangeExtractor:f=h,overscan:m=1,onLoadRange:g,loadMoreIndicator:p,suggestions:x}){var v,j;const S=o.useRef(null),I=o.useRef(0);if(i.useViewportIntersect(r,1,".oj-collection-loadmore, .oj-collection-placeholder",()=>{var e;const t=d(r.scroller(),S.current,m,f,null!==(e=I.current)&&void 0!==e?e:0);t&&g(t)}),o.useEffect(()=>{if(0===I.current){let e=0;const t=S.current.querySelectorAll(c);t.length>0&&(t.forEach(t=>{e+=t.offsetHeight}),I.current=e/t.length)}}),!(e&&(E=e,E&&E.data&&E.offset>=0&&E.totalSize>=0)))return t.jsx("div",{ref:S});var E;const z=e.data,P=e.offset,b=P+z.length,w=e.totalSize,C=P>=0?{fromIndex:0,toIndex:P,which:"topPlaceholder",estimateItemSize:null!==(v=I.current)&&void 0!==v?v:0}:void 0,H=b&&b<=w?{fromIndex:b,toIndex:w,which:"bottomPlaceholder",estimateItemSize:null!==(j=I.current)&&void 0!==j?j:0}:void 0,R=p&&"atLeast"===e.sizePrecision&&b<=w;return t.jsxs("div",Object.assign({ref:S,style:"will-change: contents"},{children:[x,C&&t.jsx(s,{context:C,placeholderHeight:a}),t.jsx(l.Collection,Object.assign({items:z},{children:(A=P,e=>{const t={index:A+e.index,data:e.data};return n(t)})})),H&&t.jsx(s,{context:H,placeholderHeight:a}),R&&t.jsx("div",Object.assign({class:u},{children:p}))]}));var A},e.getVirtualizedRangeExtractor=a});
//# sourceMappingURL=VirtualizedCollection-76b70956.js.map
