define("oj-c/editable-value/UNSAFE_useAssistiveText/useAssistiveText",["require","exports","preact/hooks"],(function(require,e,t){"use strict";function a(e,t,a,s,n){return(null==e?void 0:e.instruction)||("none"===(null==n?void 0:n.validatorHint)?void 0:t)||(null==a?void 0:a.definition)||("none"===(null==n?void 0:n.converterHint)?void 0:s)}function s(e){if(!e.length)return;return e.map((e=>"function"==typeof e.getHint?e.getHint():void 0)).filter(Boolean).join("\n")}Object.defineProperty(e,"__esModule",{value:!0}),e.useAssistiveText=void 0,e.useAssistiveText=function({addBusyState:e,converter:n,displayOptions:r,help:i,helpHints:l,validators:o}){var u,c;const[d,f]=(0,t.useState)(o&&o.length?s(o):void 0),v=(0,t.useRef)();return(0,t.useEffect)((()=>{if(!o||!o.length)return void f(void 0);f(s(o));const t=o.map((e=>e.hint)).filter(Boolean),a=v.current=Symbol(),n=null==e?void 0:e("resolving the async validator hints");Promise.allSettled(t).then((e=>{f((t=>{const s=e.map((e=>"fulfilled"===e.status?e.value:void 0)).filter(Boolean);return a===v.current&&s.length?[t,...s].join("\n"):t})),null==n||n()}))}),[o]),{assistiveText:a(i,d,l,null!==(c=null===(u=null==n?void 0:n.getHint)||void 0===u?void 0:u.call(n))&&void 0!==c?c:void 0,r),helpSourceLink:null==l?void 0:l.source,helpSourceText:null==l?void 0:l.sourceText}}})),define("oj-c/editable-value/utils/utils",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isShallowEqual=e.normalizeValue=e.treatNull=e.createMessageFromError=void 0,e.createMessageFromError=function(e){return"function"==typeof e.getMessage?{severity:"error",detail:e.getMessage().detail}:{severity:"error",detail:e.message}},e.treatNull=function(e,t){return null===e?t:e},e.normalizeValue=function(e){return"string"==typeof e&&""===e?null:e};e.isShallowEqual=(e,t)=>e===t||e.length===t.length&&e.every(((e,a)=>e===t[a]))})),define("oj-c/editable-value/UNSAFE_useComponentMessaging/useComponentMessaging",["require","exports","@oracle/oraclejet-preact/hooks/UNSAFE_useUncontrolledState","preact/hooks","../utils/utils"],(function(require,e,t,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useComponentMessaging=void 0,e.useComponentMessaging=function({messagesCustom:e=[],onMessagesCustomChanged:n}){const[r,i]=(0,t.useUncontrolledState)(e,n),[l,o]=(0,a.useState)([]),[u,c]=(0,a.useState)([]),d=(0,a.useRef)(e),f=(0,a.useCallback)(((...e)=>{o((t=>[...t,...e]))}),[]),v=(0,a.useCallback)((e=>{o((t=>[...t,e]))}),[]),p=(0,a.useCallback)((()=>{o([]),c([])}),[]),m=(0,a.useCallback)((()=>{c([])}),[]),h=(0,a.useCallback)((()=>{o([]),c([]),i([])}),[]),y=(0,a.useCallback)((()=>r.some((e=>"error"===e.severity))),[r]),g=(0,a.useCallback)((()=>0===l.length&&0===u.length&&!1===y()),[l,u,y]),V=(0,a.useCallback)((()=>0!==u.length),[u]),b=(0,a.useCallback)((()=>{o((e=>[...e,...u])),c([])}),[u]);return(0,a.useEffect)((()=>{d.current!==e&&(d.current=e,(0,s.isShallowEqual)(r,e)||i(e))}),[r,e]),(0,a.useMemo)((()=>({componentMessages:l,deferredComponentMessages:u,messagesCustom:r,visibleMessages:[...r,...l],addComponentMessage:f,addDeferredComponentMessage:v,clearAllComponentMessages:p,clearAllMessages:h,clearDeferredComponentMessages:m,hasCustomErrorMessages:y,hasHiddenMessages:V,hasNoErrorMessages:g,setComponentMessages:o,setDeferredComponentMessages:c,showHiddenMessages:b})),[l,u,r,y,V,g,b])}})),define("oj-c/editable-value/UNSAFE_useConverter/useConverter",["require","exports","ojs/ojconverter-nativenumber","preact/hooks","@oracle/oraclejet-preact/hooks/UNSAFE_useTranslationBundle","../utils/utils"],(function(require,e,t,a,s,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useConverter=e.ConverterErrorSymbol=void 0,e.ConverterErrorSymbol=Symbol("ConverterError"),e.useConverter=function({componentMessagingState:r,validationState:i,converter:l}){const o=(0,s.useTranslationBundle)("@oracle/oraclejet-preact").inputNumber_converterParseError(),u=(0,a.useCallback)((a=>{if(!l||(""===(s=a)||null===s))return a;var s;try{return l.parse(a)}catch(a){const s=(null==a?void 0:a.cause)===t.USER_INPUT_ERROR?{severity:"error",detail:o}:(0,n.createMessageFromError)(a);return r.setComponentMessages([s]),i.setValid("invalidShown"),e.ConverterErrorSymbol}}),[l,r,i]),c=(0,a.useCallback)(((e,t=!1)=>{var a;if(!l||function(e){return null===e}(e))return null!==(a=(0,n.treatNull)(e,""))&&void 0!==a?a:"";try{return l.format(e)}catch(a){return t||(r.setComponentMessages([(0,n.createMessageFromError)(a)]),i.setValid("invalidShown")),(0,n.treatNull)(e,"")}}),[l,r,i]);return(0,a.useMemo)((()=>({format:c,parse:u})),[c,u])}})),define("oj-c/editable-value/UNSAFE_useConverterLifecycle/useConverterLifecycle",["require","exports","preact/hooks"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useConverterLifecycle=void 0,e.useConverterLifecycle=function({converter:e,validationState:a,refreshDisplayValue:s,runFullValidationAndUpdateValue:n}){const r=(0,t.useRef)(e);(0,t.useEffect)((()=>{if(r.current===e)return;r.current=e;const{valid:t}=a;if("invalidShown"===t)n();else s()}),[e,a,s,n])}}));var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("oj-c/editable-value/UNSAFE_useDeferredValidators/useDeferredValidators",["require","exports","ojs/ojvalidator-required","preact/hooks"],(function(require,e,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useDeferredValidators=void 0,t=__importDefault(t),e.useDeferredValidators=function({labelHint:e,required:s,requiredMessageDetail:n}){const r=(0,a.useMemo)((()=>s?new t.default({label:e,messageDetail:n}):null),[s]);return(0,a.useMemo)((()=>[r].filter(Boolean)),[r])}})),define("oj-c/editable-value/UNSAFE_useStaleIdentity/useStaleIdentity",["require","exports","preact/hooks"],(function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useStaleIdentity=void 0,e.useStaleIdentity=function(){const e=(0,t.useRef)(new Map);return{setStaleIdentity:(0,t.useCallback)((t=>{const a=Symbol();return e.current.set(t,a),{isStale:()=>a!==e.current.get(t)}}),[])}}}));var __awaiter=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function i(e){try{o(s.next(e))}catch(e){r(e)}}function l(e){try{o(s.throw(e))}catch(e){r(e)}}function o(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}o((s=s.apply(e,t||[])).next())}))};define("oj-c/editable-value/UNSAFE_useValidators/useValidators",["require","exports","@oracle/oraclejet-preact/hooks/UNSAFE_useUncontrolledState","preact/hooks","../UNSAFE_useStaleIdentity/useStaleIdentity","../utils/utils"],(function(require,e,t,a,s,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useValidators=e.ValidationResult=void 0,e.ValidationResult={VALID:"VALID",INVALID:"INVALID",STALE:"STALE"},e.useValidators=function({componentMessagingState:r,defaultValidState:i,deferredValidators:l=[],validators:o=[],addBusyState:u,onValidChanged:c}){const[d,f]=(0,t.useUncontrolledState)(i,c),{setStaleIdentity:v}=(0,s.useStaleIdentity)();(0,a.useLayoutEffect)((()=>{void 0!==i&&(null==c||c(i))}),[]);const p=(0,a.useCallback)(((e,t={})=>__awaiter(this,void 0,void 0,(function*(){const{addComponentMessage:a,clearAllComponentMessages:s,clearAllMessages:i,hasCustomErrorMessages:c,setComponentMessages:d}=r,{doNotClearMessagesCustom:p=!1}=t,m=c();if(f("pending"),p?s():i(),0===o.length&&0===l.length)return f(m&&p?"invalidShown":"valid"),!0;const h=[],y=[];for(const t of[...l,...o])try{const a=t.validate(e);a instanceof Promise&&y.push(a.then((()=>{}),(e=>(0,n.createMessageFromError)(e))))}catch(e){h.push((0,n.createMessageFromError)(e))}if(!h.length&&!y.length)return f(m&&p?"invalidShown":"valid"),!0;const g=0!==h.length;if(g&&(d(h),f("invalidShown")),!y.length)return!g;const V=null==u?void 0:u("running validation"),{isStale:b}=v("useValidators-validate");let S=!1;for(const e of y){const t=yield e;t&&!b()&&(a(t),f("invalidShown"),S=!0)}return g||S||b()||f(m&&p?"invalidShown":"valid"),null==V||V(),!g&&!S}))),[r,l,o]),m=(0,a.useCallback)((e=>{const t=[];for(const a of l)try{a.validate(e)}catch(e){t.push((0,n.createMessageFromError)(e))}if(t.length)return t}),[l]),h=(0,a.useCallback)(((t,a={})=>__awaiter(this,void 0,void 0,(function*(){const{isStale:s}=v("useValidationLifeCycle-validateValueOnInternalChange"),n=null==u?void 0:u("running validateValueOnInternalChange"),r=yield p(t,a);return null==n||n(),s()?e.ValidationResult.STALE:r?e.ValidationResult.VALID:e.ValidationResult.INVALID}))),[u,p]),y=(0,a.useCallback)((t=>{const{clearAllMessages:a,setDeferredComponentMessages:s}=r;a();const n=m(t);return n?(s(n),f("invalidHidden")):f("valid"),e.ValidationResult.VALID}),[r,m]);return(0,a.useMemo)((()=>({valid:d,setValid:f,deferredValidate:m,fullValidate:p,validateValueOnExternalChange:y,validateValueOnInternalChange:h})),[d,m,p,y,h])}}));__awaiter=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function i(e){try{o(s.next(e))}catch(e){r(e)}}function l(e){try{o(s.throw(e))}catch(e){r(e)}}function o(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}o((s=s.apply(e,t||[])).next())}))};define("oj-c/editable-value/UNSAFE_useValidationLifecycle/useValidationLifecycle",["require","exports","preact/hooks","../UNSAFE_useConverter/useConverter","../UNSAFE_useValidators/useValidators","../utils/utils"],(function(require,e,t,a,s,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useValidationLifecycle=void 0,e.useValidationLifecycle=function({componentMessagingState:e,deferredValidators:r,validationState:i,validators:l,getValueForValidation:o,setValueAfterValidation:u}){const c=(0,t.useRef)(r),d=(0,t.useRef)(l),f=(0,t.useRef)(e.messagesCustom),v=(0,t.useCallback)((()=>__awaiter(this,void 0,void 0,(function*(){const{valid:e,validateValueOnInternalChange:t}=i,n=o(e);if(n===a.ConverterErrorSymbol)return;(yield t(n,{doNotClearMessagesCustom:!0}))===s.ValidationResult.VALID&&u(n)}))),[i,o,u]);return(0,t.useEffect)((()=>{const t=o("valid");if(t===a.ConverterErrorSymbol)return;const{deferredValidate:s,setValid:n}=i,{hasCustomErrorMessages:r,setDeferredComponentMessages:l}=e,u=s(t);u&&(l(u),n("invalidHidden")),r()&&n("invalidShown")}),[]),(0,t.useEffect)((()=>{if(c.current===r)return;const{valid:t,deferredValidate:s,setValid:n}=i,{clearDeferredComponentMessages:l,setDeferredComponentMessages:u}=e;switch(c.current=r,t){case"valid":const e=o(t);if(e!==a.ConverterErrorSymbol){const t=s(e);t&&(u(t),n("invalidHidden"))}break;case"invalidHidden":0===r.length&&(n("valid"),l());break;case"invalidShown":v()}}),[r,e,i,o,v]),(0,t.useEffect)((()=>{if(d.current!==l&&(d.current=l,"invalidShown"===i.valid))v()}),[l,i]),(0,t.useEffect)((()=>{if((0,n.isShallowEqual)(f.current,e.messagesCustom))return;const{messagesCustom:t,hasCustomErrorMessages:a,hasHiddenMessages:s,hasNoErrorMessages:r}=e,{valid:l,setValid:o}=i;if(f.current=t,a())o("invalidShown");else{if("pending"===l)return;r()?o("valid"):s()&&o("invalidHidden")}}),[e,i]),{runFullValidationAndUpdateValue:v}}})),define("oj-c/editable-value/UNSAFE_useValue/useValue",["require","exports","@oracle/oraclejet-preact/hooks/UNSAFE_useUncontrolledState","preact/hooks","../utils/utils"],(function(require,e,t,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useValue=void 0,e.useValue=function({value:e,format:n,parse:r,onRawValueChanged:i,onTransientValueChanged:l,onValueChanged:o}){const[u,c]=(0,t.useUncontrolledState)(n(e,!0),i),[d,f]=(0,t.useUncontrolledState)(e,o);(0,a.useEffect)((()=>{void 0!==u&&(null==i||i(u))}),[]);const[v,p]=(0,t.useUncontrolledState)(e,l);return(0,a.useEffect)((()=>{void 0!==e&&(null==l||l(e))}),[]),{displayValue:u,transientValue:v,value:d,getValueForValidation:(0,a.useCallback)((e=>"invalidShown"!==e?d:r((0,s.normalizeValue)(u))),[u,d,r]),setValueAfterValidation:(0,a.useCallback)((e=>{f(e),c(n(e))}),[n]),setDisplayValue:c,setTransientValue:p,setValue:f,refreshDisplayValue:(0,a.useCallback)((()=>{c(n(d))}),[d,n])}}})),define("oj-c/editable-value/UNSAFE_useValueLifecycle/useValueLifecycle",["require","exports","preact/hooks","../UNSAFE_useValidators/useValidators"],(function(require,e,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useValueLifecycle=void 0,e.useValueLifecycle=function({value:e,valueState:s,format:n,validateValueOnExternalChange:r}){const i=(0,t.useRef)(e);(0,t.useEffect)((()=>{const{value:e,setDisplayValue:t}=s;t(n(e))}),[]),(0,t.useEffect)((()=>{if(i.current!==e&&(i.current=e,void 0!==e&&e!==s.value)){const{setDisplayValue:t,setValue:i}=s;r(e)===a.ValidationResult.VALID&&(i(e),t(n(e)))}}),[e,s,n])}}));__awaiter=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function i(e){try{o(s.next(e))}catch(e){r(e)}}function l(e){try{o(s.throw(e))}catch(e){r(e)}}function o(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}o((s=s.apply(e,t||[])).next())}))};define("oj-c/editable-value/UNSAFE_useEditableValue/useEditableValue",["require","exports","preact/hooks","../UNSAFE_useComponentMessaging/useComponentMessaging","../UNSAFE_useConverter/useConverter","../UNSAFE_useConverterLifecycle/useConverterLifecycle","../UNSAFE_useDeferredValidators/useDeferredValidators","../UNSAFE_useValidationLifecycle/useValidationLifecycle","../UNSAFE_useValidators/useValidators","../UNSAFE_useValue/useValue","../UNSAFE_useValueLifecycle/useValueLifecycle","../utils/utils"],(function(require,e,t,a,s,n,r,i,l,o,u,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useEditableValue=void 0,e.useEditableValue=function({ariaDescribedBy:e,converter:d,displayOptions:f,implicitComponentValidator:v,labelHint:p,messagesCustom:m,required:h,requiredMessageDetail:y,shouldNormalizeValueOnCommit:g=!0,validators:V,value:b,addBusyState:S,onMessagesCustomChanged:_,onRawValueChanged:C,onValidChanged:E,onValueChanged:M,onTransientValueChanged:A,wrapValueState:j}){const D=(0,a.useComponentMessaging)({messagesCustom:m,onMessagesCustomChanged:_}),{clearAllMessages:L,visibleMessages:F}=D,w=(0,r.useDeferredValidators)({labelHint:p,required:h,requiredMessageDetail:y}),x=v?V?[v,...V]:[v]:V,U=(0,l.useValidators)({componentMessagingState:D,defaultValidState:"valid",deferredValidators:w,validators:x,addBusyState:S,onValidChanged:E}),{validateValueOnExternalChange:I,validateValueOnInternalChange:k}=U,{format:R,parse:P}=(0,s.useConverter)({componentMessagingState:D,converter:d,validationState:U}),O=(0,o.useValue)({value:b,format:R,parse:P,onRawValueChanged:C,onTransientValueChanged:A,onValueChanged:M}),T=j?j(O):O,{displayValue:N,value:q,getValueForValidation:B,setValueAfterValidation:z,refreshDisplayValue:H,setDisplayValue:W,setTransientValue:K,setValue:$}=T,{runFullValidationAndUpdateValue:X}=(0,i.useValidationLifecycle)({componentMessagingState:D,validationState:U,deferredValidators:w,validators:V,getValueForValidation:B,setValueAfterValidation:z});(0,n.useConverterLifecycle)({converter:d,validationState:U,refreshDisplayValue:H,runFullValidationAndUpdateValue:X}),(0,u.useValueLifecycle)({value:b,valueState:T,format:R,validateValueOnExternalChange:I});const G=(0,t.useCallback)((e=>P(g?(0,c.normalizeValue)(e):e)),[g,P]),Y=(0,t.useCallback)(((e,t=!0)=>__awaiter(this,void 0,void 0,(function*(){const a=yield k(e);return a===l.ValidationResult.VALID&&t&&$(e),a}))),[k]),J=(0,t.useCallback)((({value:e})=>__awaiter(this,void 0,void 0,(function*(){const t=G(e);if(t===s.ConverterErrorSymbol)return;const a=t;(yield Y(a))===l.ValidationResult.VALID&&W(R(a))}))),[R,Y,G]),Q=(0,t.useCallback)((({value:e})=>{W(null!=e?e:"")}),[]),Z=(0,t.useCallback)((()=>{L(),I(q),H()}),[q,L,H,I]),ee=(0,t.useCallback)((()=>__awaiter(this,void 0,void 0,(function*(){const{fullValidate:e}=U,{displayValue:t,value:a,setValueAfterValidation:n}=T,r=G(t);if(r===s.ConverterErrorSymbol)return"invalid";const i=r,l=null==S?void 0:S("running component method validate"),o=yield e(i);return null==l||l(),o?(i!==a&&n(i),"valid"):"invalid"}))),[U,T,S,G]),te=(0,t.useCallback)((()=>{const{hasHiddenMessages:e,showHiddenMessages:t}=D,{setValid:a}=U;e()&&(t(),a("invalidShown"))}),[D,U]);return{value:q,setValue:$,displayValue:N,setDisplayValue:W,setTransientValue:K,methods:{reset:Z,validate:ee,showMessages:te},textFieldProps:{messages:"none"!==(null==f?void 0:f.messages)?F:void 0,value:N,ariaDescribedBy:e,onCommit:J,onInput:Q},onCommitValue:Y,format:R,normalizeAndParseValue:G}}}));__awaiter=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function i(e){try{o(s.next(e))}catch(e){r(e)}}function l(e){try{o(s.throw(e))}catch(e){r(e)}}function o(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}o((s=s.apply(e,t||[])).next())}))};define("oj-c/hooks/UNSAFE_useListData/useListData",["require","exports","ojs/ojdataproviderfactory","preact/hooks"],(function(require,e,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useListData=void 0;const s=Object.freeze({status:"loading",data:null}),n={isInitialFetchDeferred:!1};e.useListData=(e,t=n)=>{const o=(0,a.useRef)(null),f=(0,a.useRef)(0),v=(0,a.useRef)(!1),p=(0,a.useRef)(null),m=t.fetchSize&&t.fetchSize>0?t.fetchSize:25;if(!e){return[u("exact"),e=>Promise.resolve()]}const h=(0,a.useMemo)((()=>r(e)),[e]),[y,g]=(0,a.useReducer)(i,s),V=(0,a.useCallback)((e=>__awaiter(void 0,void 0,void 0,(function*(){const a={attributes:t.attributes,sortCriteria:t.sortCriteria,filterCriterion:t.filterCriterion,offset:e.offset,size:e.count};try{const t=(yield h.fetchByOffset(a)).results,s=!0===v.current?"exact":"atLeast";g({status:"success",data:{offset:e.offset,data:t,totalSize:f.current,sizePrecision:s}})}catch(e){g({status:"error",error:e})}}))),[h,t.attributes,t.filterCriterion,t.sortCriteria]),b=(0,a.useCallback)((()=>__awaiter(void 0,void 0,void 0,(function*(){g({status:"loading",data:null});const e=h.fetchFirst({attributes:t.attributes,sortCriteria:t.sortCriteria,filterCriterion:t.filterCriterion,size:m})[Symbol.asyncIterator]();p.current=e;try{const a=yield e.next();f.current=a.value.data.length,void 0!==a.done&&(v.current=a.done);const s=t.initialRowsFetched&&t.initialRowsFetched>0?t.initialRowsFetched:m;V({offset:0,count:Math.min(f.current,s)})}catch(e){g({status:"error",error:e}),p.current=null}}))),[h,V,t.attributes,t.filterCriterion,t.sortCriteria,t.fetchSize]),S=(0,a.useCallback)((e=>__awaiter(void 0,void 0,void 0,(function*(){if(null===p.current)b();else{const t=e.offset+e.count;if(t>f.current){if(null==o.current){const a=l(p,f.current,t);o.current=a;try{const t=yield a;void 0!==t.done&&(v.current=t.done);const s=t.total;s>0&&(f.current=s,V({offset:e.offset,count:Math.min(f.current-e.offset,e.count)})),o.current=null}catch(e){g({status:"error",error:e}),o.current=null}}}else V(e)}}))),[y,b,V]),_=(0,a.useCallback)((()=>{p.current=null,o.current=null,f.current=0,v.current=!1,0===t.initialRowsFetched?g(u("atLeast")):t.isInitialFetchDeferred?g({status:"loading",data:null}):b()}),[b,t.isInitialFetchDeferred,t.initialRowsFetched]);(0,a.useEffect)((()=>{_()}),[_]);const C=(0,a.useCallback)((e=>{if("success"===y.status&&y.data){const a=y.data;let s=!1;if(e.detail.add){const n=c(e.detail.add,a,t,!0);f.current=f.current+n,s=n>0||"exact"===a.sizePrecision,0===n&&(v.current=!1)}if(e.detail.remove){const n=c(e.detail.remove,a,t,!1);f.current=f.current-n,s=s||n>0}e.detail.update&&(s=s||d(e.detail.update,a,t)),s&&V({offset:a.offset,count:a.data.length})}}),[y,t,V]),E=(0,a.useCallback)((e=>{var t;let a=-1;const s=null===(t=e.detail)||void 0===t?void 0:t.disregardAfterKey;if(s&&"success"===y.status){const e=y.data.data.findIndex((e=>e.metadata.key===s));if(e>-1&&(a=y.data.data.length-e-1),0===a&&y.data.data.length>=m)return}a>-1&&"success"===y.status?(f.current=f.current-a,S({offset:y.data.offset,count:Math.max(y.data.data.length,m)})):_()}),[y,_]);return(0,a.useEffect)((()=>(h.addEventListener("refresh",E),h.addEventListener("mutate",C),()=>{h.removeEventListener("refresh",E),h.removeEventListener("mutate",C)})),[h,_,C]),[y,S]};const r=e=>(0,t.getEnhancedDataProvider)(e,{fetchFirst:{caching:"visitedByCurrentIterator"}}),i=(e,t)=>e.status===t.status&&"loading"===t.status?e:t,l=(e,t,a)=>__awaiter(void 0,void 0,void 0,(function*(){return yield o(e,t,a)})),o=(e,t,a)=>__awaiter(void 0,void 0,void 0,(function*(){const s=e.current;if(null===s)return{total:-1,done:void 0};const n=yield s.next();return s===e.current?(t+=n.value.data.length)>=a||n.done?{total:t,done:n.done}:o(e,t,a):{total:-1,done:void 0}})),u=e=>({status:"success",data:{offset:0,data:[],totalSize:0,sizePrecision:e}}),c=(e,t,a,s)=>{var n;let r=0;if(f(e,a)){const a=s?null===(n=e.indexes)||void 0===n?void 0:n.sort():e.indexes;let i=t.totalSize-1;null==a||a.forEach((e=>{e<=i&&(r=r+=1,s&&(i=i+=1))}))}return r},d=(e,t,a)=>{if(f(e,a)){const a=e.indexes?e.indexes:[],s=t.offset,n=s+t.data.length;for(let e=0;e<a.length;e++)if(a[e]>=s&&a[e]<n)return!0}return!1},f=(e,t)=>e.indexes&&null==t.sortCriteria&&null==t.filterCriterion})),define("oj-c/select-common/utils/utils",["require","exports"],(function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isEmpty=e.DEFAULT_VALUE_ITEMS=e.DEFAULT_VALUE_ITEM=e.DEFAULT_VALUE=e.DEFAULT_ITEM_CONTEXT=void 0,e.DEFAULT_ITEM_CONTEXT=null,e.DEFAULT_VALUE=null,e.DEFAULT_VALUE_ITEM=null,e.DEFAULT_VALUE_ITEMS=null,e.isEmpty=function(e){return!e||(Array.isArray(e)?0===e.length:(e instanceof Set||e instanceof Map)&&0===e.size)}})),define("oj-c/select-common/UNSAFE_useDataProviderListeners/useDataProviderListeners",["require","exports","@oracle/oraclejet-preact/utils/UNSAFE_logger","preact/hooks","../utils/utils"],(function(require,e,t,a,s){"use strict";function n(e){return e instanceof Set?new Set(e.values()):e}function r(e,t){return e instanceof Set&&t instanceof Set||e instanceof Map&&t instanceof Map?e.size===t.size:"object"==typeof e&&"object"==typeof t?e.key===t.key:e===t}function i(e,t){return e instanceof Set?e.has(t):null!=e&&e===t}function l(e,t){return e instanceof Set||e instanceof Map?(e.delete(t),e):"number"==typeof e||"string"==typeof e?e===t?s.DEFAULT_VALUE:e:"object"==typeof e&&e.key===t?s.DEFAULT_VALUE_ITEMS:e}Object.defineProperty(e,"__esModule",{value:!0}),e.useDataProviderListeners=void 0,e.useDataProviderListeners=function({dataProvider:e,setValue:o,setValueToSync:u,setValueItemsToSync:c,value:d,valueItems:f}){const v=d instanceof Set,p=(0,a.useCallback)((()=>{(0,s.isEmpty)(d)||(u(n(d)),c(s.DEFAULT_VALUE_ITEMS))}),[d]),m=(0,a.useCallback)((e=>{if((0,s.isEmpty)(d))return;let a=n(d);if(null!=e.detail.remove){e.detail.remove.keys.forEach((e=>{i(a,e)&&(a=l(a,e),t.Logger.warn(`\n              ${v?"SelectMultiple":"SelectSingle"}: selected value removed from data provider: ${e}`))})),r(a,d)&&(o((0,s.isEmpty)(a)?s.DEFAULT_VALUE:a),u((0,s.isEmpty)(a)?s.DEFAULT_VALUE:a))}var p;if(!(0,s.isEmpty)(a)&&null!=e.detail.update){const t=e.detail.update.keys;let n=(0,s.isEmpty)(f)?f:(p=f)instanceof Map?new Map(p.entries()):Object.assign({},p);t.forEach((e=>{i(a,e)&&(n=l(n,e))})),r(n,f)&&(u(a),c((0,s.isEmpty)(n)?s.DEFAULT_VALUE_ITEMS:n))}}),[d,f]);(0,a.useEffect)((()=>(null==e||e.addEventListener("refresh",p),null==e||e.addEventListener("mutate",m),()=>{null==e||e.removeEventListener("refresh",p),null==e||e.removeEventListener("mutate",m)})),[e,m,p])}})),define("oj-c/select-common/UNSAFE_useWrapDataProvider/useWrapDataProvider",["require","exports","ojs/ojdataproviderfactory","preact/hooks"],(function(require,e,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useWrapDataProvider=void 0,e.useWrapDataProvider=function(e){return(0,a.useMemo)((()=>e?(0,t.getEnhancedDataProvider)(e,{fetchFirst:{caching:"visitedByCurrentIterator"}}):e),[e])}})),define("oj-c/select-common/UNSAFE_useWrapValueState/useWrapValueState",["require","exports","preact/hooks","../utils/utils"],(function(require,e,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useWrapValueState=void 0,e.useWrapValueState=function({arItemContexts:e,isLoading:s,preactValueItems:n,setPreactValueItems:r}){const i=(0,t.useCallback)((e=>t=>"invalidShown"!==t||s?e:(0,a.isEmpty)(n)?null:e),[s,n]),l=(0,t.useCallback)((()=>{r(e)}),[e]);return{wrapValueState:(0,t.useCallback)((e=>Object.assign(Object.assign({},e),{getValueForValidation:i(e.value),refreshDisplayValue:l})),[i,l])}}})),define("oj-c/select-multiple/useSyncValueAndValueItems",["require","exports","@oracle/oraclejet-preact/utils/UNSAFE_logger","oj-c/select-common/utils/utils","preact/hooks"],(function(require,e,t,a,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useSyncValueAndValueItems=void 0,e.useSyncValueAndValueItems=function({addBusyState:e,dataProvider:n,setIsLoading:r,setValue:i,setValueItems:l,value:o,valueItems:u}){const c=(0,s.useRef)(o),d=(0,s.useRef)(u),f=o&&o instanceof Set&&o.size>0,v=u&&u.size>0,p=(0,s.useRef)(null),m=(0,s.useCallback)((()=>{if(!f)return void(v&&l(a.DEFAULT_VALUE_ITEMS));const s=Array.from(o.keys()).reduce(((e,t)=>(v&&u.has(t)||e.push(t),e)),[]);if(0===s.length){const e=new Map;return o.forEach((t=>{e.set(t,u.get(t))})),void l(e)}r(!0);const i=e("useSyncValueItems: calling fetchByKeys"),c={};p.current=c,n.fetchByKeys({keys:new Set(s)}).then((e=>{if(c===p.current){const t=function(e,t,a){return Array.from(e.keys()).reduce(((e,s)=>{if(t&&t.has(s))return e.set(s,t.get(s)),e;const n=a.get(s);if(!n)throw new Error(`oj-c-select-multiple: could not fetch data for key ${s}`);return e.set(s,{key:s,data:n.data,metadata:n.metadata?n.metadata:{currKey:s}}),e}),new Map)}(o,u,e.results);l(t)}})).catch((e=>{c===p.current&&t.Logger.error(`SelectMultiple: fetchByKeys promise rejected: ${e}`)})).finally((()=>{c===p.current&&r(!1),i()}))}),[n,f,v,o,u]),h=(0,s.useCallback)((()=>{if(!v)return void(f&&i(a.DEFAULT_VALUE));const e=Array.from(u.keys()),t=new Set(e);if(!(o&&o instanceof Set&&o.size===t.size))return void i(t);const s=Array.from(o.keys());e.some(((e,t)=>e!==s[t]))&&i(t)}),[f,v,o,u]);(0,s.useEffect)((()=>{f?m():v&&h()}),[]),(0,s.useEffect)((()=>{o!==c.current&&u!==d.current?(c.current=o,d.current=u,o?m():h()):o!==c.current?(c.current=o,m()):u!==d.current&&(d.current=u,h())}),[o,u])}})),define("oj-c/select-multiple/useValueItems",["require","exports","@oracle/oraclejet-preact/hooks/UNSAFE_useUncontrolledState","preact/hooks"],(function(require,e,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useValueItems=void 0,e.useValueItems=function(e,s){const[n,r]=(0,t.useUncontrolledState)(e,s);(0,a.useEffect)((()=>{n!==e&&r(e)}),[e]);const i=(0,a.useMemo)((()=>n?Array.from(n.values()):void 0),[n]);return{valueItems:n,setValueItems:r,preactValueItems:i}}}));__awaiter=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))((function(n,r){function i(e){try{o(s.next(e))}catch(e){r(e)}}function l(e){try{o(s.throw(e))}catch(e){r(e)}}function o(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}o((s=s.apply(e,t||[])).next())}))};var __rest=this&&this.__rest||function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(a[s[n]]=e[s[n]])}return a};define("oj-c/select-multiple/useSelectMultiplePreact",["require","exports","oj-c/editable-value/UNSAFE_useEditableValue/useEditableValue","oj-c/editable-value/UNSAFE_useValidators/useValidators","oj-c/hooks/UNSAFE_useListData/useListData","oj-c/select-common/UNSAFE_useDataProviderListeners/useDataProviderListeners","oj-c/select-common/UNSAFE_useWrapDataProvider/useWrapDataProvider","oj-c/select-common/UNSAFE_useWrapValueState/useWrapValueState","oj-c/select-common/utils/utils","ojs/ojdataprovider","preact/hooks","./useSyncValueAndValueItems","./useValueItems"],(function(require,e,t,a,s,n,r,i,l,o,u,c,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.useSelectMultiplePreact=void 0,e.useSelectMultiplePreact=function(e,f){var{data:v,disabled:p,displayOptions:m,itemText:h,labelEdge:y,labelHint:g,labelStartWidth:V,messagesCustom:b,placeholder:S,readonly:_,required:C,textAlign:E,userAssistanceDensity:M,value:A,valueItems:j,virtualKeyboard:D,onMessagesCustomChanged:L,onValidChanged:F,onValueChanged:w,onValueItemsChanged:x}=e,U=__rest(e,["data","disabled","displayOptions","itemText","labelEdge","labelHint","labelStartWidth","messagesCustom","placeholder","readonly","required","textAlign","userAssistanceDensity","value","valueItems","virtualKeyboard","onMessagesCustomChanged","onValidChanged","onValueChanged","onValueItemsChanged"]);const[I,k]=(0,u.useState)(void 0),[R,P]=(0,u.useState)(!1),{valueItems:O,setValueItems:T,preactValueItems:N}=(0,d.useValueItems)(j,x),[q,B]=(0,u.useState)(N);(0,u.useEffect)((()=>{B(N)}),[N]);const{wrapValueState:z}=(0,i.useWrapValueState)({arItemContexts:N,isLoading:R,preactValueItems:q,setPreactValueItems:B}),{methods:H,onCommitValue:W,setValue:K,textFieldProps:$,value:X}=(0,t.useEditableValue)({ariaDescribedBy:U["aria-describedby"],displayOptions:m,messagesCustom:b,required:C,value:A,addBusyState:f,onMessagesCustomChanged:L,onValidChanged:F,onValueChanged:w,wrapValueState:z}),{ariaDescribedBy:G,messages:Y}=$,J=null===X||X instanceof Set&&0===X.size,Q=(0,r.useWrapDataProvider)(v),[Z,ee]=(0,u.useState)(X),[te,ae]=(0,u.useState)(O);(0,u.useEffect)((()=>{ee(X)}),[X]),(0,u.useEffect)((()=>{ae(O)}),[O]),(0,n.useDataProviderListeners)({dataProvider:Q,setValue:K,setValueToSync:ee,setValueItemsToSync:ae,value:X,valueItems:O}),(0,c.useSyncValueAndValueItems)({addBusyState:f,dataProvider:Q,setIsLoading:P,setValue:K,setValueItems:T,value:Z,valueItems:te});const[se,ne]=(0,s.useListData)(Q,{filterCriterion:I,initialRowsFetched:0}),re=(0,u.useCallback)((e=>__awaiter(this,void 0,void 0,(function*(){(yield W(e.value&&e.value.size>0?e.value:l.DEFAULT_VALUE))===a.ValidationResult.INVALID&&B(void 0)}))),[W]),ie=(0,u.useCallback)((({searchText:e})=>{const t=e&&e.length>0?o.FilterFactory.getFilter({filterDef:{text:e}}):void 0;k(t)}),[]);return{methods:H,selectMultipleProps:{ariaDescribedBy:G,data:se.data,isDisabled:p,isLoading:R,isReadonly:_,isRequired:C,isRequiredShown:C&&J,itemText:h,label:g,labelEdge:y,labelStartWidth:V,messages:Y,onCommit:re,onFilter:ie,onLoadRange:ne,placeholder:S,textAlign:E,userAssistanceDensity:M,valueItems:q,virtualKeyboard:D}}}}));var __decorate=this&&this.__decorate||function(e,t,a,s){var n,r=arguments.length,i=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,a,s);else for(var l=e.length-1;l>=0;l--)(n=e[l])&&(i=(r<3?n(i):r>3?n(t,a,i):n(t,a))||i);return r>3&&i&&Object.defineProperty(t,a,i),i};__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("oj-c/select-multiple/select-multiple",["require","exports","preact/jsx-runtime","@oracle/oraclejet-preact/translationBundle","@oracle/oraclejet-preact/UNSAFE_SelectMultiple","@oracle/oraclejet-preact/hooks/UNSAFE_useTabbableMode","ojs/ojcontext","ojs/ojvcomponent","ojs/ojvcomponent-binding","preact","preact/compat","preact/hooks","oj-c/editable-value/UNSAFE_useAssistiveText/useAssistiveText","./useSelectMultiplePreact","@oracle/oraclejet-preact/hooks/UNSAFE_useFormContext","@oracle/oraclejet-preact/hooks/UNSAFE_useFormVariantContext","css!oj-c/select-multiple/select-multiple-styles.css"],(function(require,e,t,a,s,n,r,i,l,o,u,c,d,f,v,p){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SelectMultiple=void 0,a=__importDefault(a),r=__importDefault(r);const m=(0,u.forwardRef)(((e,a)=>{
const{busyContextRef:n,displayOptions:r,help:i,helpHints:l}=e,o=(0,c.useRef)(),u=(0,c.useCallback)((t=>{var a;return null===(a=n.current)||void 0===a?void 0:a.addBusyState({description:`oj-c-select-multiple id=${e.id}: ${t}`})}),[]),{selectMultipleProps:v,methods:m}=(0,f.useSelectMultiplePreact)(e,u);(0,c.useImperativeHandle)(a,(()=>Object.assign({blur:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.blur()},focus:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.focus()}},m)),[m]);const h=(0,d.useAssistiveText)({displayOptions:r,help:i,helpHints:l}),y=(0,p.useFormVariantContext)();return(0,t.jsx)(s.SelectMultiple,Object.assign({ref:o},h,v,{variant:y}))}));let h=class extends o.Component{constructor(){super(...arguments),this.busyContextRef=(0,o.createRef)(),this.selectMultipleRef=(0,o.createRef)(),this.rootRef=(0,o.createRef)()}componentDidMount(){this.busyContextRef.current=r.default.getContext(this.rootRef.current).getBusyContext()}render(e){const a={isFormLayout:void 0!==e.containerReadonly,isReadonly:e.containerReadonly,labelWrapping:e.labelWrapping};return(0,t.jsx)(i.Root,Object.assign({id:e.id,ref:this.rootRef},{children:(0,t.jsx)(v.FormContext.Provider,Object.assign({value:a},{children:(0,t.jsx)(m,Object.assign({busyContextRef:this.busyContextRef,ref:this.selectMultipleRef},e))}))}))}componentWillUnmount(){this.busyContextRef.current=null}reset(){var e;null===(e=this.selectMultipleRef.current)||void 0===e||e.reset()}showMessages(){var e;null===(e=this.selectMultipleRef.current)||void 0===e||e.showMessages()}validate(){var e;return null===(e=this.selectMultipleRef.current)||void 0===e?void 0:e.validate()}blur(){var e;null===(e=this.selectMultipleRef.current)||void 0===e||e.blur()}focus(){var e;null===(e=this.selectMultipleRef.current)||void 0===e||e.focus()}};h.defaultProps={data:null,disabled:!1,displayOptions:{messages:"display"},help:{instruction:""},helpHints:{definition:"",source:"",sourceText:void 0},messagesCustom:[],readonly:!1,required:!1,userAssistanceDensity:"reflow",value:null,valueItems:null,virtualKeyboard:"auto"},h._metadata={properties:{containerReadonly:{type:"boolean",binding:{consume:{name:"containerReadonly"}}},data:{type:"object|null"},disabled:{type:"boolean"},displayOptions:{type:"object",properties:{messages:{type:"string",enumValues:["display","none"]}}},help:{type:"object",properties:{instruction:{type:"string"}}},helpHints:{type:"object",properties:{definition:{type:"string"},source:{type:"string"},sourceText:{type:"string"}}},itemText:{type:"string|number|function"},labelEdge:{type:"string",enumValues:["start","none","top","inside"],binding:{consume:{name:"containerLabelEdge"}}},labelHint:{type:"string"},labelStartWidth:{type:"string",binding:{consume:{name:"labelWidth"}}},labelWrapping:{type:"string",enumValues:["wrap","truncate"],binding:{consume:{name:"labelWrapping"}}},messagesCustom:{type:"Array<object>",writeback:!0},placeholder:{type:"string"},readonly:{type:"boolean",binding:{consume:{name:"containerReadonly"}}},required:{type:"boolean"},requiredMessageDetail:{type:"string"},textAlign:{type:"string",enumValues:["start","right","end"]},userAssistanceDensity:{type:"string",enumValues:["reflow","efficient"],binding:{consume:{name:"containerUserAssistanceDensity"}}},value:{type:"object|null",writeback:!0},valueItems:{type:"object|null",writeback:!0},virtualKeyboard:{type:"string",enumValues:["number","text","auto","search","email","tel","url"]},valid:{type:"string",enumValues:["valid","pending","invalidHidden","invalidShown"],readOnly:!0,writeback:!0}},extension:{_WRITEBACK_PROPS:["messagesCustom","valid","value","valueItems"],_READ_ONLY_PROPS:["valid"],_OBSERVED_GLOBAL_PROPS:["aria-describedby","id"]},methods:{reset:{},showMessages:{},validate:{},blur:{},focus:{}}},h._translationBundleMap={"@oracle/oraclejet-preact":a.default},h._consumedContexts=[p.FormVariantContext,n.TabbableModeContext],h=__decorate([(0,i.customElement)("oj-c-select-multiple")],h),e.SelectMultiple=h}));
//# sourceMappingURL=select-multiple.js.map