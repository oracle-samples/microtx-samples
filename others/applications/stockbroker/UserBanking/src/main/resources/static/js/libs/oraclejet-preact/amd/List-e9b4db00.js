function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}define(["exports","preact/jsx-runtime","preact/hooks",'module',"./utils/UNSAFE_classNames","./utils/UNSAFE_mergeProps","./utils/UNSAFE_keys","./LoadMoreCollection-d199803f","./PRIVATE_VirtualizedCollection","./hooks/UNSAFE_useTabbableMode","./UNSAFE_FocusTrap","./hooks/UNSAFE_useId","./classNames-e842f86a","./FocusTrap-b42970ea","./hooks/PRIVATE_useSelection","./hooks/PRIVATE_useCurrentKey","./hooks/PRIVATE_useCollectionFocusRing","./hooks/PRIVATE_useTabbableModeSet","./hooks/PRIVATE_useItemAction","./UNSAFE_Skeleton","./UNSAFE_Flex","./utils/PRIVATE_collectionUtils","./UNSAFE_Selector","./VirtualizedCollection-76b70956","./Flex-348d5a41","./Skeleton-247a04d3"],function(e,t,r,n,o,i,a,l,s,c,u,d,f,b,g,m,y,v,p,x,h,k,A,S,j,_){"use strict";const T=e=>{switch(e){case"listbox":return{list:"listbox",item:"presentation",cell:"option"};case"treegrid":return{list:"treegrid",item:"row",cell:"gridcell"};default:return{list:"grid",item:"row",cell:"gridcell"}}},C="oj-listview-item",E=".oj-listview-item",w="_7kjlic",I="zb4i9v",F="_3flsax",R="_1ujbkqb",K="xa9ou4",P="_1uhxozi",V="fgauec",M="_1kk804t",N="_3w8ojl",O="_1kpof5v",z="p7shb3";function L({children:e,itemKey:n,itemIndex:o,isFocused:i,isFocusRingVisible:a,isGridlineVisible:l,isSelected:s,isTopGridlineVisible:u=!1,isTabbable:g=!1,role:m,selectionMode:y,suggestion:v,currentItemVariant:p}){const x=r.useRef(null),h=r.useMemo(()=>T(m),[m]),k="option"===h.cell?{role:h.cell,"aria-posinset":o+1,"aria-setsize":-1}:{role:h.cell},A=f.classNames([w,C,i&&a&&N,l&&I,u&&F,U(y,s)&&!s&&R,s&&K,s&&"single"===y&&P,"end"===v&&!l&&!(s&&"single"===y)&&V,"highlight"===p&&i&&!s&&M]),S=f.classNames([O,"multiple"===y&&z]);return t.jsx("div",Object.assign({"aria-rowindex":o+1,"data-oj-key":n,class:A,ref:x,role:h.item},v&&{"data-oj-suggestion":!0},"number"==typeof n&&{"data-oj-key-type":"number"},{children:t.jsx("div",Object.assign({id:d.useId(),class:S,"aria-posinset":o+1,"aria-setsize":-1,onKeyDown:e=>{!g||"ArrowDown"!==e.key&&"ArrowUp"!==e.key||e.stopPropagation()},"aria-colindex":1,"aria-selected":"none"!==y?s:void 0},k,{children:t.jsx(c.TabbableModeContext.Provider,Object.assign({value:{isTabbable:g}},{children:t.jsx(b.FocusTrap,Object.assign({isDisabled:!g,restoreFocusRef:!1},{children:e}))}))}))}))}const U=(e,t)=>"none"!==e&&("multiple"===e||!t),D="enqxta";function H({children:e,minimumCount:n=1}){const[o,i]=r.useState(!1);r.useEffect(()=>{setTimeout(()=>{i(!0)},50)},[]);const a=f.classNames([D]);return o&&e?t.jsx("div",Object.assign({class:a,role:"presentation"},{children:_toConsumableArray(Array(n)).map((t,r)=>e(r))})):null}const q="_1jxfdu2",B="khfvki",G="_5w4fs1";const W=e=>{const t=null==e?void 0:e.data,r=$(t);if(0===r)return null;return t.slice(0,r).reduce((e,t,n)=>{const o=t.metadata.key;return n===r-1?e.set(o,"end"):e.set(o,!0),e},new Map)},$=e=>{if(!e)return 0;const t=e.findIndex(e=>!e.metadata.suggestion);return-1===t?0:t},Y=(e,t)=>{if(e&&t){const r=t.getBoundingClientRect(),n=e.getBoundingClientRect();n.bottom>r.bottom?t.scrollTop=t.scrollTop+(n.bottom-r.bottom):n.top<r.top&&(t.scrollTop=t.scrollTop-(r.top-n.top))}},J=(e,t)=>null!=t?t:{scroller:()=>e.current},Q={all:!1,keys:new Set},X=(e,t)=>{const r=t.data.map(e=>e.metadata.key),n=r.indexOf(e.value.start),o=r.indexOf(e.value.end),i=Math.min(n,o),a=Math.max(n,o);return-1===i?{offset:0,count:t.totalSize}:r.slice(i,a+1)};function Z({sparkleHeight:e}){if(e<=0)return null;const r=e+"px",n=f.classNames([B]),o=f.classNames([G]);return t.jsx("div",Object.assign({class:o},{children:t.jsx("div",{class:n,style:{height:r}})}),"sparkle")}const ee=t.jsx(H,Object.assign({minimumCount:25},{children:()=>t.jsx(j.Flex,Object.assign({height:"12x",align:"center"},{children:t.jsx(_.Skeleton,{height:"4x"})}))})),te=t.jsx(H,Object.assign({minimumCount:3},{children:()=>t.jsx(j.Flex,Object.assign({height:"12x",align:"center"},{children:t.jsx(_.Skeleton,{height:"4x"})}))})),re=(e,t)=>{if(t){const r=Math.min(t.offset,e.offset+e.totalSize),n=r-e.offset;n>0&&(e={offset:r,data:e.data.slice(n,n+t.count),totalSize:e.totalSize,sizePrecision:e.sizePrecision})}return e};e.List=function({accessibleSummary:e,allowTabbableMode:n=!0,children:o,currentKey:s,data:c,gridlines:u,loadingIndicator:d=ee,onCurrentKeyChange:b,onLoadRange:x,onSelectionChange:h,onItemAction:j,rangeExtractor:_,role:C="grid",selectedKeys:w=Q,selectionMode:I="none",viewportConfig:F,currentItemVariant:R="none",isVirtualized:K=!0}){const P=r.useRef(null),V=r.useMemo(()=>T(C),[C]),M=r.useRef(),N=r.useRef(),O=r.useRef(),[z,U]=r.useState(0),D="none"===I?void 0:"multiple"===I,H=null===c?void 0:"exact"===c.sizePrecision?c.totalSize:-1,B=f.classNames([q]),{currentKeyProps:G}=m.useCurrentKey(e=>k.keyExtractor(e,E),k.getPrevNextKey(P.current,s,!0,E),k.getPrevNextKey(P.current,s,!1,E),s,b),$=e=>{var t;return!!(null===(t=P.current)||void 0===t?void 0:t.contains(e))},[ne,oe]=y.useCollectionFocusRing($,["ArrowUp","ArrowDown"]);let ie=!1;const[ae,le]=v.useTabbableModeSet($,e=>k.keyExtractor(e,E),s,(e,t)=>{var r;(null===e||$(e))&&(t?(ie=!0,setTimeout(()=>{var e;null===(e=P.current)||void 0===e||e.focus()},0)):null===(r=P.current)||void 0===r||r.focus())},e=>{b&&b({value:e})});r.useEffect(()=>{if(null!=s&&P.current){const e=k.findElementByKey(P.current,s,E);if(e){const t=null==F?void 0:F.scroller();Y(e,null!=t?t:P.current);const r=e.querySelector(`[role=${V.cell}]`);r&&P.current.setAttribute("aria-activedescendant",r.id)}}},[s,c,V.cell,F]);const se=r.useCallback(e=>{h&&(!1===e.value.all&&e.value.keys.size>0&&(M.current=Array.from(e.value.keys.values()).pop()),h(e))},[M,h]),ce=r.useCallback(e=>{if(c&&h){const t=X(e,c);Array.isArray(t)?h({value:{all:!1,keys:new Set(t)},target:null}):(N.current={detail:e,range:{offset:c.offset,count:c.data.length}},x(t))}},[c,h,x]),ue=r.useCallback(()=>{if(P.current&&b&&(!n||ae(void 0))){const e=O.current||k.getFirstVisibleKey(P.current,E);a.isKeyDefined(e)&&b({value:e})}},[n,b,ae]),de=r.useCallback(e=>{var t,r;const n=k.keyExtractor(e.target,E);n&&"checkbox"===(null===(t=e.relatedTarget)||void 0===t?void 0:t.getAttribute("type"))&&(null===(r=P.current)||void 0===r||r.focus(),b&&n&&b({value:n}))},[b]),fe=r.useCallback(e=>{!a.isKeyDefined(s)&&b&&ue(),!n&&de(e)},[n,s,ue,de,b]),{selectionProps:be}=g.useSelection(e=>e===P.current?void 0===s?null:s:k.keyExtractor(e,E),w,I,!1,"replace",se,M.current,s,(e,t)=>k.getPrevNextKey(P.current,e,t,E),e=>{if(P.current){const t=k.findElementByKey(P.current,e,E);if(t){const e=null==F?void 0:F.scroller();Y(t,null!=e?e:P.current)}}},ce);if(c&&void 0!==N.current&&h){const e=X(N.current.detail,c);Array.isArray(e)&&h({value:{all:!1,keys:new Set(e)},target:null});const t=N.current?N.current.range:{offset:c.offset,count:c.data.length};c=re(c,t),N.current=void 0,x(t)}const ge=r.useMemo(()=>W(c),[c]),me=t.jsx(Z,{sparkleHeight:z}),ye=p.useItemAction(s,c,j,E);r.useEffect(()=>{var e,t;if(ge){const r=null===(e=P.current)||void 0===e?void 0:e.querySelector("."+S.PLACEHOLDER_STYLE_CLASS);let n=(null==r?void 0:r.offsetHeight)||0;const o=null===(t=P.current)||void 0===t?void 0:t.querySelectorAll("[data-oj-suggestion]");null==o||o.forEach(e=>n+=e.offsetHeight),U(n)}},[ge]);const ve=r.useCallback(e=>{const r="multiple"===I?()=>t.jsx(A.Selector,{onChange:se,rowKey:e.data.metadata.key,selectedKeys:w}):void 0;return{index:e.index,data:e.data.data,metadata:e.data.metadata,selector:r}},[I,w,se]),pe=e=>{const r=ve(e),i=null==ge?void 0:ge.get(r.metadata.key),l=n&&ae(r.metadata.key),d=s===r.metadata.key&&!l,f=a.containsKey(w,r.metadata.key);return t.jsx(L,Object.assign({isFocused:d,isFocusRingVisible:ne&&!ie,isGridlineVisible:(b=r.index,"visible"===(null==u?void 0:u.item)&&(b+1!==(null==c?void 0:c.totalSize)||"visible"===(null==u?void 0:u.bottom))),isSelected:f,isTabbable:n&&ae(r.metadata.key),itemIndex:r.index,itemKey:r.metadata.key,role:C,selectionMode:I,currentItemVariant:R},i&&{suggestion:i},0===r.index&&{isTopGridlineVisible:"visible"===(null==u?void 0:u.item)&&"visible"===(null==u?void 0:u.top)},{children:o(r)}),r.metadata.key);var b};F=J(P,F);const xe=K?t.jsx(S.VirtualizedCollection,Object.assign({data:c,itemSelector:E,loadMoreIndicator:te,onLoadRange:x,rangeExtractor:_,suggestions:me,viewportConfig:F},{children:pe})):t.jsx(l.LoadMoreCollection,Object.assign({data:c,loadMoreIndicator:te,onLoadRange:x,suggestions:me,viewportConfig:F},{children:pe})),he=r.useCallback(e=>{const t=k.keyExtractor(e.target,E);a.isKeyDefined(t)&&(O.current=t)},[]);return t.jsx("div",Object.assign({},i.mergeProps(n?le:{},G,oe,be,ye,{onFocus:fe,onPointerDown:he}),{role:C,"aria-rowcount":H,"aria-colcount":1,ref:P,class:B,tabIndex:0,"aria-label":e,"aria-multiselectable":D},{children:null==c?d:xe}))},e.SkeletonContainer=H});
//# sourceMappingURL=List-e9b4db00.js.map
